---
export interface ProgramTrack {
  title: string;
  description: string;
  icon: string;
  highlights: string[];
  link: string;
  color: 'primary' | 'accent' | 'blue' | 'cyan' | 'green' | 'orange' | 'yellow';
}

export interface ProgramHighlightsProps {
  title: string;
  subtitle: string;
  tracks: ProgramTrack[];
}

const { title, subtitle, tracks } = Astro.props;

const getColorClasses = (color: string) => {
  switch (color) {
    case 'primary':
      return {
        bg: 'bg-gradient-to-br from-slate-700 to-slate-800 text-white',
        border: 'border-white/10',
        icon: 'bg-white/20 backdrop-blur-sm text-white',
        title: 'text-white',
        button: 'bg-white/90 text-slate-700 hover:bg-white',
        checkmark: 'text-white/90',
        text: 'text-white/90'
      };
    case 'accent':
      return {
        bg: 'bg-gradient-to-br from-slate-800 to-primary-700 text-white',
        border: 'border-white/10',
        icon: 'bg-white/20 backdrop-blur-sm text-white',
        title: 'text-white',
        button: 'bg-white/90 text-primary-700 hover:bg-white',
        checkmark: 'text-white/90',
        text: 'text-white/90'
      };
    case 'blue':
      return {
        bg: 'bg-gradient-to-br from-primary-700 to-accent-600 text-white',
        border: 'border-white/10',
        icon: 'bg-white/20 backdrop-blur-sm text-white',
        title: 'text-white',
        button: 'bg-white/90 text-accent-700 hover:bg-white',
        checkmark: 'text-white/90',
        text: 'text-white/90'
      };
    case 'cyan':
      return {
        bg: 'bg-gradient-to-br from-accent-600 to-accent-700 text-white',
        border: 'border-white/10',
        icon: 'bg-white/20 backdrop-blur-sm text-white',
        title: 'text-white',
        button: 'bg-white/90 text-accent-700 hover:bg-white',
        checkmark: 'text-white/90',
        text: 'text-white/90'
      };
    case 'green':
      return {
        bg: 'bg-gradient-to-br from-accent-700 to-emerald-700 text-white',
        border: 'border-white/10',
        icon: 'bg-white/20 backdrop-blur-sm text-white',
        title: 'text-white',
        button: 'bg-white/90 text-emerald-700 hover:bg-white',
        checkmark: 'text-white/90',
        text: 'text-white/90'
      };
    case 'orange':
      return {
        bg: 'bg-gradient-to-br from-emerald-700 to-slate-700 text-white',
        border: 'border-white/10',
        icon: 'bg-white/20 backdrop-blur-sm text-white',
        title: 'text-white',
        button: 'bg-white/90 text-slate-700 hover:bg-white',
        checkmark: 'text-white/90',
        text: 'text-white/90'
      };
    case 'yellow':
      return {
        bg: 'bg-gradient-to-br from-yellow-600 to-orange-600 text-white',
        border: 'border-white/10',
        icon: 'bg-white/20 backdrop-blur-sm text-white',
        title: 'text-white',
        button: 'bg-white/90 text-yellow-700 hover:bg-white',
        checkmark: 'text-white/90',
        text: 'text-white/90'
      };
    default:
      return {
        bg: 'bg-gradient-to-br from-primary-600 to-accent-600 text-white',
        border: 'border-white/10',
        icon: 'bg-white/20 backdrop-blur-sm text-white',
        title: 'text-white',
        button: 'bg-white/90 text-primary-600 hover:bg-white',
        checkmark: 'text-white/90',
        text: 'text-white/90'
      };
  }
};
---

<section class="pt-4 pb-16 bg-gradient-to-b from-primary-50 via-primary-100/30 to-white dark:from-primary-900 dark:via-primary-800/50 dark:to-primary-800 transition-colors duration-300">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="text-center mb-16">
      <h2 class="text-4xl font-heading font-bold text-primary-900 dark:text-primary-100">{title}</h2>
    </div>
    
    <!-- Program Cards Grid -->
        <!-- Program Cards Grid -->
    <div class="relative">
      <!-- Unified gradient background for all cards -->
      <div class="absolute inset-0 bg-gradient-to-r from-slate-700 via-primary-700 via-accent-600 via-accent-700 to-emerald-700 rounded-3xl opacity-95 dark:opacity-100"></div>
      
      <!-- Cards container -->
      <div class="relative grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-1">
        {tracks.map((track) => {
          const colors = getColorClasses(track.color);
          return (
            <div class={`program-card group relative rounded-2xl backdrop-blur-sm bg-white/5 hover:bg-white/10 border border-white/10 p-8 transform hover:-translate-y-2 hover:scale-[1.02] transition-all duration-300 animate-initial`}>
              <!-- Icon -->
              <div class="inline-flex items-center justify-center w-14 h-14 rounded-xl bg-white/20 backdrop-blur-sm text-white mb-6 group-hover:scale-110 transition-transform duration-300">
                <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d={track.icon}></path>
                </svg>
              </div>
              
              <!-- Title -->
              <h3 class="text-xl font-semibold text-white mb-4">{track.title}</h3>
              
              <!-- Description -->
              <p class="text-white/90 mb-6 leading-relaxed">{track.description}</p>
              
              <!-- Highlights -->
              <ul class="space-y-2 mb-8">
                {track.highlights.map((highlight) => (
                  <li class="flex items-start">
                    <svg class="w-4 h-4 mt-1 mr-2 flex-shrink-0 text-white/90" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                    <span class="text-sm text-white/90">{highlight}</span>
                  </li>
                ))}
              </ul>
              
              <!-- CTA Button -->
              <a 
                href={track.link} 
                class="inline-flex items-center justify-center w-full px-4 py-3 text-sm font-semibold rounded-lg transition-all duration-200 bg-white/90 hover:bg-white text-slate-800 group-hover:shadow-lg"
              >
                Learn More
                <svg class="w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </a>
            </div>
          );
        })}
      </div>
    </div>
    
    <!-- Bottom CTA -->
    <div class="text-center mt-16">
      <div class="animate-card bg-white/50 dark:bg-primary-800/50 backdrop-blur-sm rounded-2xl p-8 shadow-sm hover:shadow-md border border-primary-100/20 dark:border-primary-700/20 transform hover:scale-[1.01] transition-all duration-300 animate-initial">
        <h3 class="text-2xl font-semibold text-primary-900 dark:text-primary-100 mb-4">Ready to Join IPAC27?</h3>
        <p class="text-primary-600 dark:text-primary-300 mb-6 max-w-2xl mx-auto">
          Be part of the world's premier particle accelerator conference and contribute to cutting-edge research
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a href="/registration/conference-registration" 
             class="bg-primary-600 hover:bg-primary-700 text-white px-8 py-4 rounded-lg font-semibold shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 inline-flex items-center justify-center">
            Register Now
            <svg class="w-5 h-5 ml-2 transition-transform duration-200 group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5-5 5M6 12h12"></path>
            </svg>
          </a>
          <a href="/authors/abstract-submission" 
             class="border-2 border-primary-600 text-primary-600 dark:text-primary-400 dark:border-primary-400 hover:bg-primary-50 dark:hover:bg-primary-800 px-8 py-4 rounded-lg font-semibold shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 inline-flex items-center justify-center">
            Submit Abstract
            <svg class="w-5 h-5 ml-2 transition-transform duration-200 group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  /* Scroll animation styles */
  .animate-initial {
    opacity: 0;
    transform: translateY(50px);
    transition: all 0.8s cubic-bezier(0.25, 0.1, 0.25, 1);
    transition-delay: var(--animation-delay, 0ms);
  }
  
  .animate-in {
    opacity: 1;
    transform: translateY(0);
  }
  
  .animate-out {
    opacity: 0;
    transform: translateY(50px);
  }
  
  /* Stagger animation delays for program cards */
  .program-card:nth-child(1) { --animation-delay: 0ms; }
  .program-card:nth-child(2) { --animation-delay: 150ms; }
  .program-card:nth-child(3) { --animation-delay: 300ms; }
  .program-card:nth-child(4) { --animation-delay: 450ms; }
</style>

<script>
  // Scroll-triggered animations
  class ScrollAnimations {
    private observer: IntersectionObserver;
    
    constructor() {
      this.observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              const element = entry.target as HTMLElement;
              element.classList.add('animate-in');
              element.classList.remove('animate-out');
            }
          });
        },
        {
          threshold: 0.1,
          rootMargin: '0px 0px -100px 0px'
        }
      );
    }
    
    public observeElements(selector: string): void {
      const elements = document.querySelectorAll(selector);
      elements.forEach((element) => {
        this.observer.observe(element);
      });
    }
    
    public disconnect(): void {
      this.observer.disconnect();
    }
  }
  
  // Initialize animations when DOM is ready
  document.addEventListener('DOMContentLoaded', () => {
    const scrollAnimations = new ScrollAnimations();
    
    // Animate program cards and other elements
    scrollAnimations.observeElements('.program-card');
    scrollAnimations.observeElements('.animate-card');
  });
</script>
</section>