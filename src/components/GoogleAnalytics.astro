---
// Google Analytics utility functions
// This component provides helper functions for tracking custom events
---

<script>
  // Extend window interface for TypeScript
  declare global {
    interface Window {
      gtag_event: (action: string, parameters?: any) => void;
      gtag_page_view: (page_title: string, page_location: string) => void;
      gtag: (...args: any[]) => void;
      dataLayer: any[];
    }
  }

  // Function to track custom events
  window.gtag_event = function(action: string, parameters: any = {}) {
    if (typeof window.gtag !== 'undefined') {
      window.gtag('event', action, parameters);
    }
  };

  // Function to track page views (useful for SPA navigation)
  window.gtag_page_view = function(page_title: string, page_location: string) {
    if (typeof window.gtag !== 'undefined') {
      window.gtag('config', import.meta.env.PUBLIC_GA_TRACKING_ID, {
        page_title: page_title,
        page_location: page_location
      });
    }
  };

  // Track common events automatically
  document.addEventListener('DOMContentLoaded', function() {
    // Track external link clicks
    document.querySelectorAll('a[href^="http"]').forEach(link => {
      const anchor = link as HTMLAnchorElement;
      if (!anchor.href.includes(window.location.hostname)) {
        anchor.addEventListener('click', function() {
          if (typeof window.gtag !== 'undefined') {
            window.gtag('event', 'click', {
              event_category: 'outbound',
              event_label: this.href
            });
          }
        });
      }
    });

    // Track file downloads
    document.querySelectorAll('a[href$=".pdf"], a[href$=".doc"], a[href$=".docx"], a[href$=".zip"]').forEach(link => {
      const anchor = link as HTMLAnchorElement;
      anchor.addEventListener('click', function() {
        if (typeof window.gtag !== 'undefined') {
          window.gtag('event', 'download', {
            event_category: 'file',
            event_label: anchor.href
          });
        }
      });
    });

    // Track registration button clicks
    document.querySelectorAll('a[href*="registration"]').forEach(link => {
      link.addEventListener('click', function() {
        if (typeof window.gtag !== 'undefined') {
          window.gtag('event', 'click', {
            event_category: 'registration',
            event_label: 'registration_link'
          });
        }
      });
    });
  });
</script>
